\documentclass[10pt,a4paper, margin=1in]{article}
\usepackage{fullpage}
\usepackage{amsfonts, amsmath, pifont}
\usepackage{amsthm}
\usepackage{graphicx}
\usepackage{flafter}
\usepackage{float}
\usepackage{pgf}
\usepackage{minted}

\usepackage{tkz-euclide}
\usepackage{tikz}
\usepackage{pgfplots}
\pgfplotsset{compat=1.13}

\usepackage{geometry}
 \geometry{
 a4paper,
 total={210mm,297mm},
 left=10mm,
 right=10mm,
 top=10mm,
 bottom=10mm,
 }
 % Write both of your names here. Fill exxxxxxx with your ceng mail address.
 \author{
  Çavuşoğlu, Arda\\
  \texttt{e2448249@ceng.metu.edu.tr}
  \and
  Çolak, Ahmet Eren\\
  \texttt{e2587921@ceng.metu.edu.tr}
}

\title{CENG 384 - Signals and Systems for Computer Engineers \\
Spring 2023 \\
Homework 2}
\begin{document}
\maketitle



\noindent\rule{19cm}{1.2pt}

\begin{enumerate}

\item %write the solution of q1
    \begin{enumerate}
    % Write your solutions in the following items.
    \item %write the solution of q1a
    $\Dot{y}(t) = x(t) - 5y(t) \longrightarrow \Dot{y}(t) + 5y(t) = x(t)$ \vspace{0.3cm}
    \item %write the solution of q1b
    $x(t) = (e^{-t} + e^{-3t})u(t), y(t) = y_p(t) + y_h(t)$ \vspace{0.2cm}\\
    $y_p(t) = Kx(t) = K(e^{-t} + e^{-3t})u(t) \longrightarrow \frac{d(K(e^{-t} + e^{-3t})u(t)}{dt} + 5K(e^{-t} + e^{-3t})u(t) = (e^{-t} + e^{-3t})u(t)$ \vspace{0.1cm}\\
    $\frac{d(K(e^{-t} + e^{-3t})u(t)}{dt} = K(-e^{-t}-3e^{-3t})u(t)$ \vspace{0.1cm} \\
    $Ku(t)(-e^{-t}-3e^{-3t}+5e^{-t}+5e^{-3t}) = (e^{-t} + e^{-3t})u(t)$ \vspace{0.1cm} \\
    $K(4e^{-t}+2e^{-3t}) = e^{-t} + e^{-3t}, K = \frac{e^{-t}+e^{-3t}}{4e^{-t}+2e^{-3t}} \longrightarrow y_p(t) = \frac{e^{-2t}+2e^{-4t}+e^{-6t}}{4e^{-t}+2e^{-3t}}$ \vspace{0.2cm} \\

    $y_h(t) = Ce^{\alpha t} \longrightarrow C\alpha e^{\alpha t} + 5Ce^{\alpha t} = 0$ \vspace{0.1cm} \\
    $C(\alpha + 5)e^{\alpha t} = 0 \longrightarrow \alpha = -5, y_h(t) = Ce^{-5t}$ \vspace{0.2cm} \\

    $y(t) = \frac{e^{-2t}+2e^{-4t}+e^{-6t}}{4e^{-t}+2e^{-3t}}u(t) + Ce^{-5t}$ \vspace{0.1cm} \\
    $y(0) = 0 \longrightarrow \frac{4}{6} + C = 0, C = -\frac{2}{3}$ \vspace{0.1cm} \\
    $y(t) =  \frac{e^{-2t}+2e^{-4t}+e^{-6t}}{4e^{-t}+2e^{-3t}}u(t)-\frac{2}{3}e^{-5t}$ \vspace{0.3cm}\\
    \end{enumerate}

\item %write the solution of q2  
	\begin{enumerate}
    % Write your solutions in the following items.
    \item %write the solution of q2a
    $x[n] = 2\delta[n] + \delta[n+1], h[n] = \delta[n-1] + 2\delta[n+1]$ \vspace{0.1cm} \\
    $h_1[n] = \delta[n-1], h_2[n] = \delta[n+1] \longrightarrow h[n] = h_1[n] + h_2[n] + h_2[n]$ \vspace{0.1cm} \\
    $x[n]*h[n] = x[n](h_1[n] + h_2[n] + h_2[n]) = x[n]*h_1[n]+x[n]*h_2[n]+x[n]*h_2[n]$ from distributivity. \vspace{0.2cm} \\
    $x[n]*h_1[n] = x[n-1] = 2\delta[n-1]+\delta[n]$ \vspace{0.1cm} \\
    $x[n]*h_2[n] = x[n+1] = 2\delta[n+1] + \delta[n+2]$ \vspace{0.1cm} \\
    $y[n] = 2\delta[n-1] + \delta[n] + 2\delta[n+1] + \delta[n+2]$ \vspace{0.2cm} \\

    
    \begin{filecontents}{data.dat}
     n   y[n] 
    -2   1.0
    -1   2.0
     0   1.0  
     1   2.0  
    \end{filecontents}


    \begin{tikzpicture}
      \begin{axis}[
          axis lines=middle,
          xlabel={$n$},
          ylabel={$\boldsymbol{y[n]}$},
          xtick={-3,-2,-1, ..., 3},
          xmin=-3, xmax=3,
          ymin=-1, ymax=3,
          xticklabel style={
            anchor=south,
            inner sep=5pt,
          }
        ]
        \addplot [ycomb, black, thick, mark=*] table [x={n}, y={y[n]}] {data.dat};
      \end{axis}
    \end{tikzpicture} 
    \vspace{0.8cm} \\
    
    \item %write the solution of q2b
    $x(t)=u(t-1)+u(t+1), h(t)=e^{-t}sin(t)u(t), y(t)=\frac{dx(t)}{dt}*h(t)$ \vspace{0.1cm} \\
    $\Dot{x}(t)=\delta(t-1) + \delta(t+1)$ \vspace{0.1cm} \\
    $x_1(t) = \delta(t-1), x_2(t)=\delta(t+1) \longrightarrow \Dot{x}(t) = x_1(t) + x_2(t)$ \vspace{0.2cm} \\
    $\Dot{x}(t)*h(t)=h(t)*\Dot{x}$ (from commutativity), $h(t)*\Dot{x}(t)=h(t)*x_1(t)+h(t)*x_2(t)$ (from distributivity) \vspace{0.2cm} \\
    $h(t)*x_1(t) = h(t-1), h(t)*x_2(t) = h(t+1)$ \vspace{0.1cm} \\
    $y(t) = h(t-1)+h(t+1) = e^{1-t}sin(t-1)u(t-1)+e^{-1-t}sin(t+1)u(t+1)$
    \end{enumerate}
    \vspace{0.3cm} 

\item %write the solution of q3
    \begin{enumerate}
    % Write your solutions in the following items.
    \item %write the solution of q3a
    $h(t) = e^{-2t}u(t), x(t) = e^{-t} y(t)=x(t)*h(t)$ \vspace{0.1cm} \\
    $x(t)*h(t) = \int_{-\infty}^{\infty} x(\tau)h(t-\tau)d\tau = \int_{-\infty}^{\infty}x(t-\tau)h(\tau)d\tau$ \vspace{0.1cm} \\
    $= \int_{0}^{t}e^{\tau-t}.e^{-2\tau}d\tau$ \vspace{0.1cm} \\
    $= e^{-t}\int_{0}^{t}e^{-\tau}d\tau$ \vspace{0.1cm} \\
    $= e^{-t}(-e^{-T})|^t_0$ \vspace{0.1cm} \\
    $e^{-t}(1-e^{-t})u(t)$ \vspace{0.3cm} \\
    \item %write the solution of q3b
    $h(t)=e^{3t}u(t), x(t) = u(t)-u(t-1) y(t) = x(t)*h(t)$ \vspace{0.1cm} \\
    $x(t) = u(t) - u(t-1) = \delta(t)$ \vspace{0.1cm} \\
    $h(t)*x(t) = h(t)*\delta(t) = h(t) = e^{3t}u(t)$ \vspace{0.3cm} \\
    \end{enumerate}

\item %write the solution of q4
    \begin{enumerate}   
    % Write your solutions in the following items.
    \item %write the solution of q4a
        Guess $y[n] = Cz^n$:
        \begin{equation*}
            Cz^n-Cz^{n-1}-Cz^{n-2} = 0
        \end{equation*}
        \begin{equation*}
            Kz^{n-2}(z^2-z-1) = 0
        \end{equation*}
        \begin{equation*}
            (z^2-z-1) = 0
        \end{equation*}
        \begin{equation*}
            z_{1,2} = \frac{1 \pm \sqrt{5}}{2}
        \end{equation*}
            
        $y[n]$ is the linear combination of solutions for $z_1$ and $z_2$.

        \begin{equation*}
            y[n] = C_1 \left ( \frac{1 + \sqrt{5}}{2} \right )^n + C_2 \left (\frac{1 - \sqrt{5}}{2} \right )^n
        \end{equation*}

        By the initial conditions $y[0] = 1$ and $y[1] = 1$, coefficients $C_1$ and $C_2$ can be calculated.

        \begin{equation*}
            C_1 = \frac{1 + \sqrt{5}}{10}, \ \ C_2 = \frac{9-\sqrt{5}}{2}
        \end{equation*}
        \begin{equation*}
            y[n] = \frac{1 + \sqrt{5}}{10}\left ( \frac{1 + \sqrt{5}}{2} \right )^n +\frac{9-\sqrt{5}}{2}\left (\frac{1 - \sqrt{5}}{2} \right )^n
        \end{equation*}
    \item %write the solution of q4b
        Assume $y(t) = Ce^{\alpha t}$, then characteristic equation will be:
        \begin{equation*}
            \alpha^3-6\alpha^2+13\alpha-10 = 0
        \end{equation*}
        \begin{equation*}
            \alpha_1 = 2, \ \ \alpha_{2,3} = 2 \pm j
        \end{equation*}

        For the imaginary part, there are 2 unique solutions.

        \begin{equation*}
            y'_1(t) = e^{2t}e^{jt} = cos(t) + jsin(t)
        \end{equation*}
        \begin{equation*}
            y'_2(t) = e^{2t}e^{-jt} = cos(t) - jsin(t)
        \end{equation*}

        \begin{equation*}
            y_1(t) = \frac{1}{2} y'_1(t)+\frac{1}{2}y'_2(t) = e^{2t}cos(t)
        \end{equation*}
        \begin{equation*}
            y_2(t)= \frac{1}{2j} y'_1(t)-\frac{1}{2j}y'_2(t) = e^{2t}sin(t)
        \end{equation*}

        Solution for the imaginary part is the linear combination of these 2 unique solutions.

        \begin{equation*}
            C_2y_1(t)+C_3y_2(t)
        \end{equation*}

        \begin{equation*}
            y(t) = C_1e^{2t} + C_2e^{2t}cos(t) + C_3e^{2t}sin(t)
        \end{equation*}

        By the initial conditions $y''(0) = 3$, $y'(0) = 1.5$, $y(0) = 1$, solution is:

        \begin{equation*}
            y(t) = 2e^{2t} - 1e^{2t}cos(t) - 0.5e^{2t}sin(t)
        \end{equation*}

    \end{enumerate}

\item %write the solution of q5
    \begin{enumerate}
    % Write your solutions in the following items.
    \item %write the solution of q5a
        Guess $y_p(t) = H(\lambda)cos(5t) = H(\lambda)(0.5e^{5jt} +0.5e^{-5jt})$. Using the linearity property solutions is in the form of:
        \begin{equation*}
            y_p(t) = 0.5 H(5j)e^{5jt} + 0.5 H(-5j)e^{-5jt}
        \end{equation*}

        where $H(\lambda)$ corresponds to the transfer function. To find the transfer function assume, input is $x(t) = e^{\lambda t}$. 
        Then output will be in the form of $H(\lambda)e^{\lambda t}$

        \begin{equation*}
            H(\lambda)e^{\lambda t} (\lambda^2+5\lambda+6)=e^{\lambda t}
        \end{equation*}
        \begin{equation*}
            H(\lambda) = \frac{1}{\lambda^2+5\lambda+6}
        \end{equation*}

        \begin{equation*}
            H(5j) = \frac{1}{-19+25j}, \ \ H(-5j) = \frac{1}{-19-25j}
        \end{equation*}

        \begin{equation*}
            y_p(t) = \frac{1}{-38+50j}e^{5jt} + \frac{1}{-38-50j}e^{-5jt}
        \end{equation*}
    \item %write the solution of q5b
        Characteristic equation of the systems is:

        \begin{equation*}
            \alpha^2+5\alpha+6 = 0
        \end{equation*}
        \begin{equation*}
            \alpha_1 = -3, \ \ \alpha_2=-2
        \end{equation*}

        Homogenious solution is $y_h(t) = C_1e^{-3t} + C_2e^{-2t}$
	\item %write the solution of q5c
        Since the system is rest initially, the homogenious solution is $0$. Then the general solution equals to:

        \begin{equation*}
            y(t) = \frac{1}{-38+50j}e^{5jt} + \frac{1}{-38-50j}e^{-5jt}
        \end{equation*}
        
    \end{enumerate}
    
\item %write the solution of q6
    \begin{enumerate}
    % Write your solutions in the following items.
    \item %write the solution of q6a
        $x[n] = \delta [n]$

        \begin{equation*}
            w[n] = \delta [n] + \frac{1}{2} w[n-1]
        \end{equation*}
        \begin{equation*}
            w[0] = \delta [0] + \frac{1}{2} w[-1] = 1
        \end{equation*}
        \begin{equation*}
            w[1] = \delta [1] + \frac{1}{2} w[0] = \frac{1}{2}
        \end{equation*}
        \begin{equation*}
            w[2] = \delta [2] + \frac{1}{2} w[1] = \frac{1}{4}
        \end{equation*}
        \begin{equation*}
            h_0[n] = w[n] = \left ( \frac{1}{2} \right )^n u[n]
        \end{equation*}
    \item %write the solution of q6b
        \begin{equation*}
            h[n] = h_0[n] * h_0[n]
        \end{equation*}
        \begin{equation*}
            h[n] = \sum_{k=-\infty}^{\infty} \left ( \frac{1}{2} \right )^k u[k] \left ( \frac{1}{2} \right )^{n-k} u[n-k]
        \end{equation*}
        \begin{equation*}
            h[n] = \sum_{k=0}^{n} \left ( \frac{1}{2} \right )^k \left ( \frac{1}{2} \right )^{n-k}
        \end{equation*}
        \begin{equation*}
            h[n] = \left ( \frac{1}{2} \right )^{n} \sum_{k=0}^{n} \left ( \frac{1}{2} \right )^k \left ( \frac{1}{2} \right )^{-k}
        \end{equation*}
        \begin{equation*}
            h[n] = \left ( \frac{1}{2} \right )^{n} \sum_{k=0}^{n} 1 = \left ( \frac{1}{2} \right )^{n}u[n]n
        \end{equation*}
	\item %write the solution of q6c
        \begin{equation*}
            y[n] = h[n] * x[n]
        \end{equation*}
        \begin{equation*}
            y[n] = \sum_{k=-\infty}^{\infty} \left ( \frac{1}{2} \right )^{k}ku[k]x[n-k]
        \end{equation*}
        \begin{equation*}
            y[n] = \sum_{k=0}^{\infty} \left ( \frac{1}{2} \right )^{k}kx[n-k]
        \end{equation*}
    \end{enumerate}
    
\item %write the solution of q7
    \begin{enumerate}
    % Write your solutions in the following items.
    \item %write the solution of q7a
        \begin{figure}[H]
            \input{7a.pgf}
            \centering
        \end{figure}
        

        Convolving with the $\delta[n-5]$ shifted the signal $5$ units to the right.
    \item %write the solution of q7b
        \input{7b3.pgf}
        \newline
        \input{7b5.pgf}
        \newline
        \input{7b10.pgf}
        \newline
        \input{7b20.pgf}

        Convolving with the N-point moving average filter reduces the noise of the signal. Noise is reduced more as $N$ increases.

        \begin{minted}{python}
            import numpy as np
            import matplotlib.pyplot as plt

            path = "hw2_signal.csv"
            file = open(path, "r")

            splitted = file.read().split(",")
            si = int(splitted[0])
            signal = [float(i) for i in splitted[1:]]

            def x(n):
                return signal[n - si] if n >= si and n <= si + len(signal) else 0

            def delta5(n):
                if n == 5: 
                    return 1
                return 0

            def npoint(N):
                def npointN(n):
                    return 1/N if n >= 0 and n <= (N-1) else 0
                return npointN

            def convolve(n, x, h):
                sum = 0
                for k in range(si, si+len(signal)):
                    sum = sum + x(k)*h(n-k)
                return sum

            range_arr = range(si, si+len(signal))
            x_arr = [x(n) for n in range_arr]
            delta5conv_arr = [convolve(n, x, delta5) for n in range_arr]
            npoint3conv_arr = [convolve(n, x, npoint(3)) for n in range_arr]
            npoint5conv_arr = [convolve(n, x, npoint(5)) for n in range_arr]
            npoint10conv_arr = [convolve(n, x, npoint(10)) for n in range_arr]
            npoint20conv_arr = [convolve(n, x, npoint(20)) for n in range_arr]

            plt.xlabel("n")
            plt.ylabel("x[n] * h[n]")
            plt.title("n vs x[n] * h[n]")
            plt.plot(range_arr, delta5conv_arr, "r")
            plt.plot(range_arr, x_arr, "b")
            plt.show()

            plt.xlabel("n")
            plt.ylabel("x[n] * m[n]")
            plt.title("n vs x[n] * m[n] (N=3)")
            plt.plot(range_arr, npoint3conv_arr)
            plt.show()

            plt.xlabel("n")
            plt.ylabel("x[n] * m[n]")
            plt.title("n vs x[n] * m[n] (N=5)")
            plt.plot(range_arr, npoint5conv_arr)
            plt.show()

            plt.xlabel("n")
            plt.ylabel("x[n] * m[n]")
            plt.title("n vs x[n] * m[n] (N=10)")
            plt.plot(range_arr, npoint10conv_arr)
            plt.show()

            plt.xlabel("n")
            plt.ylabel("x[n] * m[n]")
            plt.title("n vs x[n] * m[n] (N=20)")
            plt.plot(range_arr, npoint20conv_arr)
            plt.show()

        \end{minted}
    \end{enumerate}    

\end{enumerate}


\end{document}


